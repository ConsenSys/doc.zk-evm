---
description: Guide to deploy a subdomain for any L1 .eth domain on Linea
---

# Deploy a Linea subdomain

This guide is intended for developers who wish to manage subdomains on Linea for domains they own 
on [L1 ENS](https://app.ens.domains/).

## Requirements 

- [L2 contracts](https://github.com/Consensys/linea-ens/tree/main/packages/linea-ens-contracts): 
These contracts, deployed on Linea, handle all operations on your subdomains, including 
registrations and setting records.
- [L1 contracts](https://github.com/Consensys/linea-ens/tree/main/packages/linea-ens-resolver): 
These contracts enable subdomains created on Linea to resolve on L1. Typically, you can reuse the 
contracts deployed for `linea.eth` unless you require customizations.
- User interface (UI): To provide a UI for managing subdomains, you can adapt the UI deployed for 
`linea.eth`, which is similar to the [Ethereum Mainnet ENS app](https://app.ens.domains/). You can 
find the Linea ENS app [here](https://names.linea.build/), and its code [here](https://github.com/Consensys/linea-ens/tree/main/packages/linea-ens-app). 
If you decide to deploy this UI, you will also need to deploy a subgraph. You can use the same 
subgraph code we used, [linea-ens-subgraph](https://github.com/Consensys/linea-ens/tree/main/packages/linea-ens-subgraph),  
but with your own values inserted into [env.ts](https://github.com/Consensys/linea-ens/blob/main/packages/linea-ens-subgraph/src/env.ts). 

You can follow the [Quick Start on Localhost](https://github.com/Consensys/linea-ens/tree/main/packages/linea-ens-app#quick-start-on-localhost) 
guide to test it locally. Replace the environment variables `BASE_DOMAIN`, `BASE_NODE`, 
`BASE_LABEL`, and `BASE_LABEL_HASH` in the env files (`.env.example` and `env.ts`) with your own 
values matching your ENS domain.

## Available methods

### Use the same approach as `linea.eth`

If you want to manage your subdomains the same way `linea.eth` subdomains are managed, you can 
deploy your own versions of the contracts Linea ENS uses by following the guide [below](#deploy-subdomain-contracts). 
This includes using the Proof of Humanity (PoH) check for registering subdomains.

### Deploy registrar contracts only 

If you prefer to deploy only your `Registrar` contracts while using the same `Registry` and 
`Resolver` contract addresses deployed for `linea.eth`, contact [**Linea Support**](https://support.linea.build/) 
to gain ownership of an L1 domain on Linea. This solution allows you to deploy only the registrar 
contracts.

### Use ENS contracts 

You can modify the original ENS contracts deployed on Ethereum Mainnet, which can be found in the 
ENS repo [here](https://github.com/ensdomains/ens-contracts). You must modify the node managed by 
the Registrar contract to match your domain's node. 

For example, for `linea.eth`, we set the node in the [contract's constructor](https://github.com/Consensys/linea-ens/blob/49c1bd707467daa3a77d06592e2523d74825bdfb/packages/linea-ens-contracts/contracts/ethregistrar/ETHRegistrarController.sol#L162). 

:::warning 

If you modify the `PublicResolver` contract and it impacts storage, you must deploy your own 
`L1Resolver` contract on L1 to match those modifications, as the `L1Resolver` uses hard-coded 
storage slots (as seen [here](https://github.com/Consensys/linea-ens/blob/1b896c9f6f77c6258926957af370bb3d692f540a/packages/linea-ens-resolver/contracts/L1Resolver.sol#L36)).

:::

## Guide

This guide explains how to deploy and configure subdomain contracts on Linea in the same way that 
they were used to create the `linea.eth` subdomain.

### Deploy subdomain contracts 

1. Clone the [Linea ENS repository](https://github.com/Consensys/linea-ens) and execute the 
following commands:

```bash
cd ./packages/linea-ens-contracts
yarn
cp .env.org .env
```

2. Replace the following keys in the `.env` file with your own information:
    
```
DEPLOYER_PRIVATE_KEY=
OWNER_PRIVATE_KEY=
INFURA_API_KEY=
```
    
3. Replace the `BASE_DOMAIN` environment variable with the L1 ENS domain you own (e.g. for `linea.eth`, it is `linea`).

4. Execute the command: 

```bash
yarn hardhat deploy --network lineaMainnet
```

5. Get the `PublicResolver` contract address in `./deployments/lineaMainnet/PublicResolver.json` 
located at the first line of the json file. E.g.:

```
"address": "0x86c5AED9F27837074612288610fB98ccC1733126",
```

    Keep this address, as you will use it shortly. We will call this address the “Linea resolver 
    target address”.

The contracts to manage your subdomains on Linea have now been deployed. The next step is to link 
these subdomains to your L1 domain on L1 for CCIP resolution to work.

### Set the Linea target resolution on your L1 ENS domain

1. Get the DNS encoded name for your ENS domain by running:

```bash
ts-node scripts/getENSHashes.ts yourdomain.eth
```

    Example with `linea.eth`: `ts-node scripts/getENSHashes.ts linea.eth` 
    
    Example output:

```bash
The namehash of 'linea.eth' is: 0x527aac89ac1d1de5dd84cff89ec92c69b028ce9ce3fa3d654882474ab4402ec3
The DNS encoded name of 'linea.eth' is: 0x056c696e65610365746800
```
    
    Keep the DNS encoded name result. (In this example it's `0x056c696e65610365746800`).
    
2. Go to the [Linea Custom Resolver contract on Etherscan](https://etherscan.io/address/0xde16ee87B0C019499cEBDde29c9F7686560f679a#writeContract).

3. In the `Write Contract` tab, connect your wallet using the "Connect with web3" button. Make sure 
to connect with the wallet containing the account that owns your L1 ENS domain. In the `setTarget` 
function add the following parameters:
    - `name`: The DNS encoded name you got from step 1.
    - `target`: The Linea resolver target address you got from step 5 of the previous section.
    
    Then click on "write" and approve the transaction.
    
4. Go to the [ENS app](https://app.ens.domains/).

5. Search for your ENS domain and go to the profile page.

6. Click on the "More" tab, and in the "Resolver" section click on "Edit".

7. Select "Custom Resolver" and add the address `0xde16ee87B0C019499cEBDde29c9F7686560f679a`.

8. Click on "Update" and approve the transaction.

The setup to manage subdomains on Linea for your ENS domain is now complete and configured 
similarly to `linea.eth`. This means anyone with an active PoH on Linea can now register a 
`subdomain.yourdomain.eth` that will be resolved on L1 ENS.